# Smart-Birdcage-Control
基于RT-Thread标准版操作系统的蓝牙遥控智能鸟笼
动态数组；王远乐；范留强；徐晨然；指导老师：赵明剑
摘要	
本项目基于 RT-Thread 标准版操作系统，设计并实现了一款集自动化饲养与互动功能于一体的智能鸟笼。通过定时控制、蓝牙遥控、声音感应等技术，解决传统养鸟过程中喂食、清洁繁琐及互动不足的问题。系统以 STM32F407 开发板为核心，集成电机、传感器、MP3 模块等硬件，通过多线程管理实现定时加食加水、蓝牙遥控逗鸟棒、声音触发安抚音乐等功能，为鸟类饲养提供智能化解决方案。
第一部分  作品概述
1.1 功能与特性
本智能鸟笼核心功能包括四大模块：
定时饲养系统：通过 PWM 控制舵机，实现每 30 分钟自动加水、每 3 小时自动加食，满足鸟类规律饮食需求；
蓝牙互动系统：基于 JDY-31 蓝牙模块，支持手机或控制器远程操控逗鸟棒正转、反转及停止，增强人与鸟的互动体验；
声音安抚系统：通过声音传感器（PD1 引脚）检测过大音量，触发 MP3 模块播放音乐，缓解鸟类应激反应；
自动化管理：基于 RT-Thread 多线程机制，统筹各功能模块协同工作，确保系统稳定运行。
系统具备操作简单、自动化程度高、兼容性强等特点，可适配不同品种鸟类的饲养需求。
1.2 应用领域
本作品主要应用于家庭宠物鸟饲养场景，解决养鸟人群因工作繁忙导致的喂食不规律、清洁繁琐等痛点。同时，其核心技术可扩展至小型宠物（如仓鼠、鹦鹉）的智能饲养设备，或动物园、宠物医院的小型动物护理装置。此外，系统中串口透传、传感器集成等方案可为嵌入式教育、智能家居领域提供参考案例。
1.3 主要技术特点
操作系统支持：基于 RT-Thread 标准版，采用线程调度、信号量、设备驱动等机制，确保多任务高效协同；
硬件集成：通过 UART2 控制 MP3 模块、UART3 连接蓝牙模块，结合 GPIO 中断实现声音传感器触发，PWM 控制舵机与电机；
通信协议：自定义蓝牙命令格式（如{"direction":1,"speed":50}），支持透传与解析，兼容主流蓝牙调试工具；
鲁棒性设计：添加命令校验、缓冲区管理、超时重传等机制，提升系统稳定性。
1.4 主要性能指标
指标项参数定时精度±1 秒 / 30 分钟蓝牙通信距离空旷环境≥10 米声音触发响应时间≤100ms工作电压5V/3.3V系统功耗待机≤50mA，工作≤200mA
1.5 主要创新点
1. 多模态互动：融合定时自动化与蓝牙远程操控，兼顾饲养便利性与互动性；
2. 应激安抚机制：通过声音传感器实时监测鸟类异常鸣叫，自动播放音乐缓解应激；
3. 轻量化设计：基于 RT-Thread 精简内核，资源占用低（RAM≤128KB），适配小型开发板。
1.6 设计流程
项目按教学周分阶段实施：
第 11 周：硬件选型（STM32F407 开发板、MP3 模块、蓝牙模块等）与采购；
第 12-15 周：依次实现时钟计时、电机控制、声音传感器与 MP3 模块驱动；
第 16 周：硬件组装与功能联调；
第 17-20 周：测试优化、文档撰写与提交。
教学周开始日期结束日期计划完成内容第11周5月5日5月11日　确定开发板，申请，整理所需硬件，购买。

第12周5月12日5月18日　实现时钟计时。

第13周5月19日5月25日　实现舵机机的定时/蓝牙操控。

第14周5月26日6月1日　搞定声音传感器的使用。

第15周6月2日6月8日　搞定蜂鸣器的使用。

第16周6月9日6月15日　完成硬件组装与功能实现。

第17周6月16日6月22日　演示视频制作，写报告。

第18周6月23日6月29日　整理上交材料，提交作品。

第19周6月30日7月6日　整理上交材料，提交作品。

第20周7月7日7月10日18点整理上交材料，提交作品。
第二部分  系统组成及功能说明
2.1 整体介绍
系统整体框架如下：
核心控制器：STM32F407 开发板，运行 RT-Thread 操作系统；​
输入模块：声音传感器（PD1）、蓝牙模块（UART3）；​
输出模块：舵机（加水）、直流电机（加食、清理）、MP3 模块（UART2）、逗鸟棒电机；​
软件模块：定时线程（加水、加食）、蓝牙透传线程、声音触发线程、MP3 控制线程。​
各模块通过 RT-Thread 设备驱动框架交互，实现数据采集、命令解析与执行。
2.2 硬件系统介绍
2.2.1 硬件整体介绍；
• 核心控制器：STM32F407 开发板，运行 RT-Thread 操作系统；
• 输入模块：声音传感器（PD1）、蓝牙模块（UART3）；
• 输出模块：舵机（加水）、直流电机（加食、清理）、MP3 模块（UART2）、逗鸟棒电机；
• 软件模块：定时线程（加水、加食）、蓝牙透传线程、声音触发线程、MP3 控制线程。
各模块通过 RT-Thread 设备驱动框架交互，实现数据采集、命令解析与执行。
2.2.2 机械设计介绍
机械设计简单，暂无可讲内容。
2.2.3 电路各模块介绍
电路连接简单，暂无可讲内容。
2.3 软件系统介绍
2.3.1 软件整体介绍；
基于 RT-Thread 操作系统，采用模块化设计，包括：​
设备驱动：UART（蓝牙、MP3）、PWM（舵机）、GPIO（传感器）；​
线程管理：定时加水线程、定时加食线程、蓝牙透传线程、声音触发线程、MP3 控制线程；​
通信协议：蓝牙命令采用 JSON 格式解析，MP3 模块采用自定义帧格式（帧头 0x7E、帧尾 0xEF）。
2.3.2 软件各模块介绍；
1. 定时线程：​
加水线程：每 30 分钟通过 PWM 控制舵机旋转 90°，持续 1 秒后复位；​
加食线程：每 3 小时控制直流电机正转 1 秒，完成加食。​
2. 蓝牙透传线程：​
通过 UART3 接收蓝牙命令，解析方向（0 - 停止、1 - 正转、2 - 反转）与速度参数，输出控制信息（暂代硬件控制）。​
3. 声音触发线程：​
声音传感器下降沿触发中断，释放信号量，触发 MP3 模块播放音乐（命令 0x01）。​
4. MP3 控制线程：​
通过 UART2 发送命令帧（如7E 02 01 EF），支持播放、暂停、音量调节等功能。

第三部分  完成情况及性能参数
3.1 整体介绍
 
3.2  工程成果（分硬件实物、软件界面等设计结果）
3.2.1 机械成果；

3.2.2 电路成果； 

3.2.3 软件成果；

实现定时加水 / 加食功能，日志输出 “加水舵机已打开 / 关闭”；​
声音传感器触发后，MP3 模块接收到播放命令（串口输出Sending command: 7E 02 01 EF）；​
蓝牙透传功能正常，可解析命令并输出控制信息（如 “蓝牙控制：逗鸟棒电机正转，速度 50%”）。
3.3  特性成果（逐个展示功能、性能参数等量化指标）；
1.定时功能：加水 / 加食误差≤1 秒，满足设计要求；​
2.声音触发：传感器可检测 80dB 以上声音，触发响应时间≤100ms；​
3.蓝牙通信：支持 10 米内稳定通信，命令解析成功率 100%；​
4.MP3 控制：可正常接收播放命令，日志显示命令发送成功。
第四部分  总结
4.1  可扩展之处
1.继续完善蓝牙遥控功能，增加手机 APP 蓝牙控制界面，支持自定义定时参数与音乐选择；
2.集成温湿度传感器，实现环境自适应调节（如自动通风）；
3.优化排泄物清理机构，采用自动刮板与集粪盒设计，提升清洁效率。
4.2  心得体会
本项目从硬件选型到软件调试，全程贯穿 “模块化” 与 “迭代开发” 思想。初期因 MP3 模块不响应命令，通过增加串口日志、校验命令格式，发现是帧头帧尾校验错误，修正后实现稳定控制；蓝牙透传线程设计中，通过信号量与互斥锁解决多线程数据竞争问题，确保命令解析准确。​
过程中深刻体会到嵌入式开发中 “硬件与软件协同调试” 的重要性：例如声音传感器中断触发频繁，通过增加 1 秒防抖机制避免误触发；MP3 模块初始化需等待 500ms，否则易导致命令失效。这些细节让我们认识到，嵌入式系统的稳定性不仅依赖代码逻辑，更需兼顾硬件时序与环境干扰。​
最终，项目实现了核心功能，但蓝牙硬件控制与机械结构仍需完善。未来将继续优化硬件集成，提升系统实用性，为养鸟爱好者提供真正便捷的智能解决方案。
第五部分  参考文献
[1] RT-Thread 工作室. (2022). RT-Thread 应用开发实战 —— 基于 STM32 智能小车（第 2 版）. 电子工业出版社.
